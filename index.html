<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>createanew.app</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            rails: { 50: '#fef2f2', 100: '#fee2e2', 200: '#fecaca', 500: '#cc0000', 600: '#b91c1c', 700: '#991b1b', 800: '#7f1d1d', 900: '#450a0a' }
          }
        }
      }
    }
  </script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
    body { font-family: 'Inter', sans-serif; }
    .option-card { transition: all 0.15s ease; }
    .option-card:hover { transform: translateY(-1px); }
    .prompt-box { transition: all 0.3s ease; }
    .copy-feedback { animation: fadeOut 1.5s ease forwards; }
    @keyframes fadeOut { 0% { opacity: 1; } 70% { opacity: 1; } 100% { opacity: 0; } }
  </style>
  <script>
    if (localStorage.getItem('theme') === 'light') {
      document.documentElement.classList.remove('dark');
    }
  </script>
</head>
<body class="bg-gray-50 dark:bg-gray-950 text-gray-900 dark:text-gray-100 min-h-screen transition-colors duration-300">

  <!-- Header -->
  <header class="border-b border-gray-200 dark:border-gray-800 bg-white/80 dark:bg-gray-950/80 backdrop-blur-sm sticky top-0 z-50 transition-colors duration-300">
    <div class="max-w-5xl mx-auto px-4 py-4 flex items-center gap-3">
      <div class="w-10 h-10 bg-rails-500 rounded-lg flex items-center justify-center font-extrabold text-white text-lg">R</div>
      <div class="flex-1">
        <h1 class="text-xl font-bold text-gray-900 dark:text-white">createanew.app</h1>
        <p class="text-xs text-gray-500 dark:text-gray-400">Build the perfect command for your new project</p>
      </div>
      <button
        id="themeToggle"
        onclick="toggleTheme()"
        class="p-2.5 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200"
        title="Toggle theme"
      >
        <!-- Sun icon (visible in dark mode) -->
        <svg class="w-5 h-5 text-yellow-500 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
        </svg>
        <!-- Moon icon (visible in light mode) -->
        <svg class="w-5 h-5 text-gray-600 block dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
        </svg>
      </button>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-4 py-8 pb-56">

    <!-- Project Name -->
    <section class="mb-10">
      <label class="block text-sm font-semibold text-gray-600 dark:text-gray-300 mb-2">Project Name</label>
      <input
        type="text"
        id="projectName"
        placeholder="my_app"
        class="w-full max-w-md bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg px-4 py-3 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-rails-500 focus:ring-1 focus:ring-rails-500 text-lg transition-colors duration-300"
        oninput="updatePrompt()"
      />
    </section>

    <!-- Database -->
    <section class="mb-10" id="section-database">
      <h2 class="text-sm font-semibold text-gray-600 dark:text-gray-300 mb-3">Database</h2>
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3" id="databaseOptions"></div>
    </section>

    <!-- CSS Framework -->
    <section class="mb-10" id="section-css">
      <h2 class="text-sm font-semibold text-gray-600 dark:text-gray-300 mb-3">CSS Framework</h2>
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3" id="cssOptions"></div>
    </section>

    <!-- JavaScript -->
    <section class="mb-10" id="section-js">
      <h2 class="text-sm font-semibold text-gray-600 dark:text-gray-300 mb-3">JavaScript Bundler</h2>
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3" id="jsOptions"></div>
    </section>

    <!-- Rails Version / Mode -->
    <section class="mb-10">
      <h2 class="text-sm font-semibold text-gray-600 dark:text-gray-300 mb-3">Application Mode</h2>
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3" id="modeOptions"></div>
    </section>

    <!-- Extra Flags -->
    <section class="mb-10">
      <h2 class="text-sm font-semibold text-gray-600 dark:text-gray-300 mb-3">Extra Options</h2>
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3" id="extraOptions"></div>
    </section>

    <!-- Skip Options -->
    <section class="mb-10">
      <h2 class="text-sm font-semibold text-gray-600 dark:text-gray-300 mb-3">Skip</h2>
      <p class="text-xs text-gray-400 dark:text-gray-500 mb-3">Select the components you want to remove from the project</p>
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3" id="skipOptions"></div>
    </section>

  </main>

  <!-- Sticky Prompt Bar -->
  <div class="fixed bottom-0 left-0 right-0 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm border-t border-gray-200 dark:border-gray-800 z-50 transition-colors duration-300">
    <div class="max-w-5xl mx-auto px-4 py-4">
      <div class="flex items-center gap-3">
        <div class="flex-1 min-w-0">
          <label class="block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1">Generated command</label>
          <div class="prompt-box bg-gray-100 dark:bg-gray-950 border border-gray-300 dark:border-gray-700 rounded-lg px-4 py-3 font-mono text-sm text-green-700 dark:text-green-400 overflow-x-auto whitespace-nowrap transition-colors duration-300" id="promptOutput">
            rails new my_app
          </div>
        </div>
        <button
          onclick="copyPrompt()"
          id="copyBtn"
          class="shrink-0 bg-rails-500 hover:bg-rails-600 text-white font-semibold px-5 py-3 rounded-lg transition-colors flex items-center gap-2 mt-5"
        >
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
          Copy
        </button>
      </div>
    </div>
  </div>

  <script>
    // ── State ──
    const state = {
      projectName: '',
      database: 'sqlite3',
      css: '',
      js: '',
      mode: '',
      extras: new Set(),
      skips: new Set()
    };

    // ── Theme ──
    function isDark() {
      return document.documentElement.classList.contains('dark');
    }

    function toggleTheme() {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', isDark() ? 'dark' : 'light');
      renderAll();
    }

    // ── Option Definitions ──
    const databases = [
      { value: 'sqlite3', label: 'SQLite3', desc: 'Default, zero config' },
      { value: 'postgresql', label: 'PostgreSQL', desc: 'Robust, popular' },
      { value: 'mysql', label: 'MySQL', desc: 'Classic, widely used' },
      { value: 'trilogy', label: 'Trilogy', desc: 'MySQL via Trilogy' },
      { value: 'oracle', label: 'Oracle', desc: 'Enterprise database' },
      { value: 'sqlserver', label: 'SQL Server', desc: 'Microsoft SQL' },
      { value: 'jdbcmysql', label: 'JDBC MySQL', desc: 'JRuby + MySQL' },
      { value: 'jdbcpostgresql', label: 'JDBC PostgreSQL', desc: 'JRuby + PostgreSQL' },
      { value: 'jdbcsqlite3', label: 'JDBC SQLite3', desc: 'JRuby + SQLite3' },
    ];

    const cssFrameworks = [
      { value: '', label: 'None', desc: 'No CSS framework' },
      { value: 'tailwind', label: 'Tailwind', desc: 'Utility-first CSS' },
      { value: 'bootstrap', label: 'Bootstrap', desc: 'Classic, ready-made components' },
      { value: 'bulma', label: 'Bulma', desc: 'Modern, flexbox-based' },
      { value: 'postcss', label: 'PostCSS', desc: 'CSS plugins' },
      { value: 'sass', label: 'Sass', desc: 'CSS preprocessor' },
    ];

    const jsBundlers = [
      { value: '', label: 'Importmap', desc: 'Rails 7+ default, no build step' },
      { value: 'bun', label: 'Bun', desc: 'Ultra-fast runtime' },
      { value: 'esbuild', label: 'esbuild', desc: 'Extremely fast bundler' },
      { value: 'webpack', label: 'Webpack', desc: 'Classic, highly configurable' },
      { value: 'rollup', label: 'Rollup', desc: 'Efficient bundler' },
    ];

    const modes = [
      { value: '', label: 'Default', desc: 'Full-stack application' },
      { value: '--api', label: 'API Only', desc: 'JSON backend only' },
      { value: '--minimal', label: 'Minimal', desc: 'Minimal configuration' },
    ];

    const extras = [
      { value: '--skip-bundle', label: 'Skip Bundle', desc: "Don't run bundle install" },
      { value: '--skip-git', label: 'Skip Git', desc: "Don't initialize repository" },
      { value: '--devcontainer', label: 'Dev Container', desc: 'Generate devcontainer config' },
      { value: '--skip-docker', label: 'Skip Docker', desc: "Don't generate Dockerfile" },
      { value: '--edge', label: 'Edge', desc: 'Use Rails from GitHub (edge)' },
      { value: '--main', label: 'Main', desc: 'Use Rails main branch' },
      { value: '--skip-keeps', label: 'Skip .keep', desc: "Don't generate .keep files" },
    ];

    const skips = [
      { value: '--skip-action-cable', label: 'Action Cable', desc: 'WebSockets' },
      { value: '--skip-action-mailer', label: 'Action Mailer', desc: 'Email sending' },
      { value: '--skip-action-mailbox', label: 'Action Mailbox', desc: 'Inbound emails' },
      { value: '--skip-action-text', label: 'Action Text', desc: 'Rich text (Trix editor)' },
      { value: '--skip-active-job', label: 'Active Job', desc: 'Background jobs' },
      { value: '--skip-active-storage', label: 'Active Storage', desc: 'File uploads' },
      { value: '--skip-hotwire', label: 'Hotwire', desc: 'Turbo + Stimulus' },
      { value: '--skip-jbuilder', label: 'Jbuilder', desc: 'JSON templates' },
      { value: '--skip-test', label: 'Tests (Minitest)', desc: 'Default test framework' },
      { value: '--skip-system-test', label: 'System Tests', desc: 'System tests (Capybara)' },
      { value: '--skip-bootsnap', label: 'Bootsnap', desc: 'Boot cache' },
      { value: '--skip-kamal', label: 'Kamal', desc: 'Kamal deploy' },
    ];

    // ── Render Functions ──
    function cardClasses(isSelected) {
      if (isSelected) {
        return 'option-card text-left px-4 py-3 rounded-lg border transition-all bg-rails-500/10 border-rails-500 ring-1 ring-rails-500 text-gray-900 dark:text-white';
      }
      return 'option-card text-left px-4 py-3 rounded-lg border transition-all bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800 text-gray-700 dark:text-gray-300 hover:border-gray-400 dark:hover:border-gray-600';
    }

    function descClasses(isSelected) {
      return isSelected ? 'text-rails-700 dark:text-rails-200' : 'text-gray-400 dark:text-gray-500';
    }

    function renderOptionGroup(containerId, options, stateKey, isMulti = false) {
      const container = document.getElementById(containerId);
      container.innerHTML = '';

      options.forEach(opt => {
        const isSelected = isMulti
          ? state[stateKey].has(opt.value)
          : state[stateKey] === opt.value;

        const card = document.createElement('button');
        card.className = cardClasses(isSelected);

        card.innerHTML = `
          <span class="block text-sm font-semibold">${opt.label}</span>
          <span class="block text-xs mt-0.5 ${descClasses(isSelected)}">${opt.desc}</span>
        `;

        card.addEventListener('click', () => {
          if (isMulti) {
            if (state[stateKey].has(opt.value)) {
              state[stateKey].delete(opt.value);
            } else {
              state[stateKey].add(opt.value);
            }
          } else {
            state[stateKey] = opt.value;
          }
          renderOptionGroup(containerId, options, stateKey, isMulti);
          updatePrompt();
        });

        container.appendChild(card);
      });
    }

    function renderAll() {
      renderOptionGroup('databaseOptions', databases, 'database');
      renderOptionGroup('cssOptions', cssFrameworks, 'css');
      renderOptionGroup('jsOptions', jsBundlers, 'js');
      renderOptionGroup('modeOptions', modes, 'mode');
      renderOptionGroup('extraOptions', extras, 'extras', true);
      renderOptionGroup('skipOptions', skips, 'skips', true);
    }

    function updatePrompt() {
      const name = document.getElementById('projectName').value.trim() || 'my_app';
      state.projectName = name;

      let parts = ['rails new', name];

      if (state.database && state.database !== 'sqlite3') {
        parts.push(`--database=${state.database}`);
      }

      if (state.css) {
        parts.push(`--css=${state.css}`);
      }

      if (state.js) {
        parts.push(`--javascript=${state.js}`);
      }

      if (state.mode) {
        parts.push(state.mode);
      }

      state.extras.forEach(flag => parts.push(flag));
      state.skips.forEach(flag => parts.push(flag));

      document.getElementById('promptOutput').textContent = parts.join(' ');
    }

    function copyPrompt() {
      const text = document.getElementById('promptOutput').textContent;
      navigator.clipboard.writeText(text).then(() => {
        const btn = document.getElementById('copyBtn');
        const originalHTML = btn.innerHTML;
        btn.innerHTML = `
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
          Copied!
        `;
        btn.classList.remove('bg-rails-500', 'hover:bg-rails-600');
        btn.classList.add('bg-green-600', 'hover:bg-green-700');

        setTimeout(() => {
          btn.innerHTML = originalHTML;
          btn.classList.remove('bg-green-600', 'hover:bg-green-700');
          btn.classList.add('bg-rails-500', 'hover:bg-rails-600');
        }, 1500);
      });
    }

    // ── Init ──
    renderAll();
    updatePrompt();
  </script>

</body>
</html>
